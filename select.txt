--------------------------------------------------------
SELECT        id_nacionalidad, pais as nacionalidad
FROM            Nacionalidad
--------------------------------------------------------
SELECT        Tecnico.id_tecnico, CAST(CONCAT(nombre, ' ', apellido_paterno, ' ', apellido_materno) AS VARCHAR(160)) AS nombre_tecnico, TipoTecnico.tipo
FROM            Tecnico INNER JOIN
                         TipoTecnico ON Tecnico.id_tipo_tecnico = TipoTecnico.id_tipo_tecnico
--------------------------------------------------------
SELECT        id_torneo, nombre_torneo
FROM            Torneo
--------------------------------------------------------
SELECT        id_jugador, CAST(CONCAT(nombre, ' ', apellido_paterno, ' ', apellido_materno) AS VARCHAR(160)) AS nombre_jugador
FROM            Jugador
--------------------------------------------------------
SELECT        id_ciudad_estadio AS id_ciudad, nombre AS nombre_ciudad
FROM            CiudadEstadio
--------------------------------------------------------
SELECT        id_ubicacion_estadio AS id_estadio, nombre_ubicacion, id_ciudad_estadio AS id_ciudad
FROM            UbicacionEstadio
--------------------------------------------------------
DECLARE @TablaTemporal 
TABLE (id_equipo_local_visitante INT PRIMARY KEY IDENTITY(1,1), local_visitante VARCHAR(50))
INSERT INTO @TablaTemporal(local_visitante)
VALUES('Local'),('Visitante')
SELECT id_equipo_local_visitante, 
CAST(local_visitante AS VARCHAR(50)) AS local_visitante FROM @TablaTemporal
--------------------------------------------------------
SELECT        id_equipo, nombre_equipo
FROM            Equipo
--------------------------------------------------------
SELECT da.id_jugador, a.id_equipo, pp.id_torneo, pp.id_ubicacion_estadio AS id_estadio, 
da.id_nacionalidad, CAST(a.fecha AS date) AS id_tiempo, e.tiempo_jugado AS minutos_jugados,
e.kilometros_recorridos, e.cantidad_pases AS pases, e.intercepciones, e.takles_ganados, 
0 AS goles_anotados, 0 AS minuto_gol
FROM            Alineacion AS a INNER JOIN
                DetalleAlineacion AS da ON a.id_alineacion = da.id_alineacion INNER JOIN
                Evento AS e ON da.id_detalle_alineacion = e.id_detalle_alineacion INNER JOIN
                ProgramaPartido AS pp ON (a.id_alineacion = pp.id_alineacion_local 
				OR a.id_alineacion = pp.id_alineacion_visitante)
UNION ALL
SELECT da.id_jugador, a.id_equipo, pp.id_torneo, pp.id_ubicacion_estadio AS id_estadio, 
da.id_nacionalidad, CAST(a.fecha AS date) AS id_tiempo, 0 AS minutos_jugados,
0 AS kilometros_recorridos, 0 AS pases, 0 AS intercepciones, 0 AS takles_ganados, 
1 AS goles_anotados, g.minuto AS minuto_gol
FROM            Alineacion AS a INNER JOIN
                DetalleAlineacion AS da ON a.id_alineacion = da.id_alineacion INNER JOIN
                Goleo AS g ON da.id_detalle_alineacion = g.id_detalle_alineacion INNER JOIN
                ProgramaPartido AS pp ON (a.id_alineacion = pp.id_alineacion_local 
				OR a.id_alineacion = pp.id_alineacion_visitante)
--------------------------------------------------------
SELECT a.id_equipo, pp.id_torneo, tc.id_tecnico, a.fecha AS id_tiempo, 1 AS cantidad_alineacion, 
CASE
	WHEN pp.id_alineacion_local = a.id_alineacion AND pp.identificador_marcador = 0 THEN 1
	WHEN pp.id_alineacion_visitante = a.id_alineacion AND pp.identificador_marcador = 1 THEN 1
	ELSE 0
	END AS partidos_ganados,
1 AS partidos_disputados, 1 AS goles_jugadores
FROM Alineacion  AS a INNER JOIN
AlineacionTecnico AS atc ON a.id_alineacion = atc.id_alineacion INNER JOIN
DetalleAlineacion AS da ON a.id_alineacion = da.id_alineacion INNER JOIN
Goleo g ON da.id_detalle_alineacion = g.id_detalle_alineacion INNER JOIN
ProgramaPartido AS pp ON (a.id_alineacion = pp.id_alineacion_local OR 
a.id_alineacion = pp.id_alineacion_visitante)
INNER JOIN
Tecnico tc ON atc.id_tecnico = tc.id_tecnico
--------------------------------------------------------
SELECT id_torneo, id_ubicacion_estadio as id_estadio, a.id_equipo as id_equipo, CAST(fecha_programada AS date) AS id_tiempo,
1 as id_equipo_local_visitante ,marcador_local as goles_marcados, 
marcador_visitante as goles_encontra,
	CASE
		WHEN marcador_local > marcador_visitante THEN 3
		WHEN marcador_visitante > marcador_local THEN 0
		ELSE 1
		END AS puntos,
	CASE
		WHEN marcador_local > marcador_visitante THEN 1
		WHEN marcador_visitante > marcador_local THEN 0
		ELSE 0
		END AS partidos_ganados,
	CASE
		WHEN marcador_local > marcador_visitante THEN 0
		WHEN marcador_visitante > marcador_local THEN 1
		ELSE 0
		END AS partidos_perdidos,
	CASE
		WHEN marcador_local = marcador_visitante THEN 1
		ELSE 0
		END AS partidos_empatados,
	(marcador_local - marcador_visitante) AS diferencia_goles
FROM ProgramaPartido, Alineacion as a
WHERE id_alineacion_local = a.id_alineacion
UNION ALL
SELECT id_torneo, id_ubicacion_estadio as id_estadio, a.id_equipo as id_equipo, fecha_programada as id_tiempo,
2 as id_local_visitante, marcador_visitante as goles_marcados, 
marcador_local as goles_encontra,
	CASE
		WHEN marcador_local < marcador_visitante THEN 3
		WHEN marcador_visitante < marcador_local THEN 0
		ELSE 1
		END AS puntos,
	CASE
		WHEN marcador_local < marcador_visitante THEN 1
		WHEN marcador_visitante < marcador_local THEN 0
		ELSE 0
		END AS partidos_ganados,
	CASE
		WHEN marcador_local < marcador_visitante THEN 0
		WHEN marcador_visitante < marcador_local THEN 1
		ELSE 0
		END AS partidos_perdidos,
	CASE
		WHEN marcador_local = marcador_visitante THEN 1
		ELSE 0
		END AS partidos_empatados,
	(marcador_visitante - marcador_local) AS diferencia_goles
FROM ProgramaPartido, Alineacion as a
WHERE id_alineacion_visitante = a.id_alineacion
--------------------------------------------------------